# BookSorter

**BookSorter** — это утилита для автоматической сортировки электронных книг и документов по смысловым категориям с использованием гибких правил. Файлы перемещаются или копируются в соответствующие папки, при этом для одного файла можно создавать несколько hardlink’ов, если он подходит под несколько категорий.

---

## 🔹 Возможности

- Сортировка файлов по тематическим группам (IT, Наука, Искусство, Дети и др.)  
- Поддержка вложенной структуры групп (подгруппы, например IT → Programming → Python)  
- Обработка файлов с UTF-8 именами, включая русские символы  
- Поддержка регулярных выражений и гибких паттернов в `Include`/`Exclude`  
- Создание hardlink’ов для одного файла в нескольких категориях  
- Поддержка тестового прогона (`--dry-run`)  
- Возможность полного перемещения файлов с удалением исходников (`--move`)  
- Автоматическая проверка, что Source и Destination на одном диске для корректной работы hardlink’ов  
- Генерация демо-конфига для быстрого старта (`--demo-config`)  
- Ведение логов с настройкой уровня логирования

---

## 🔹 Установка

1. Склонируйте репозиторий или скачайте скрипт `sort_books.py` и конфиг `config.yaml`.  
2. Установите Python ≥ 3.7.  
3. Установите зависимости:  

```bash
pip install pyyaml
Убедитесь, что скрипт и конфиг находятся в одной папке, либо укажите путь к конфигу через --config.

🔹 Использование
Основной запуск
bash
Копировать код
python sort_books.py --src ./books_src --dst ./books_sorted
--src — папка с исходными книгами

--dst — папка для сортированных файлов

Ключи
--dry-run — тестовый прогон, файлы не копируются и не удаляются, логируется только действия

--move — после обработки исходные файлы удаляются

--demo-config — создаёт демонстрационный конфиг config_demo.yaml

--log — путь к лог-файлу

--log-level — уровень логирования (INFO, DEBUG, WARNING)

🔹 Конфигурация
Конфигурация хранится в YAML-файле (config.yaml) и описывает структуру групп:

Структура
yaml
Копировать код
groups:
  - name: IT
    groups:
      - name: Programming
        groups:
          - name: Python
            include: ["Python"]
          - name: C++
            include: ["regex:C\\+\\+", "Cplusplus"]
      - name: Systems
        include: ["Windows", "Linux"]
  - name: Science
    groups:
      - name: Physics
        include: ["Physics", "Физика"]
Пояснения:
Group (name) — имя группы, одновременно имя папки на диске

include — обязательные паттерны для попадания файла в группу. Можно указать:

Слова (Python, Office)

Множественные варианты через | (Quantum|Mechanics)

Паттерны «и» через * (PHP*MySQL)

Регулярные выражения через regex: (regex:C\\+\\+)

exclude — необязательные паттерны, по которым файлы исключаются из группы

Вложенные groups позволяют строить иерархию

Если файл подходит нескольким группам, мастер-копия делается в группу с самым высоким приоритетом (наибольшая длина паттерна), в остальные группы создаются hardlink’и

🔹 Правила редактирования конфигурации
Указывайте только реально нужные группы — Misc не используется. Файлы, не попавшие ни в одну группу, остаются на месте.

Для специальных символов (C++, C#) используйте regex:.

Если хотите обрабатывать научные файлы общего назначения, создайте подгруппу вроде Science\General с паттерном "Science".

Регистрозависимость не учитывается — все сравнения идут в нижнем регистре.

Проверяйте уникальность имен групп, чтобы избежать конфликтов при создании папок.

🔹 Логирование
Логи выводятся в консоль и, при указании --log, в файл

Уровни логирования: DEBUG, INFO, WARNING, ERROR

В --dry-run лог показывает все действия, но не создаёт файлов и папок

🔹 Пример использования
Генерация демо-конфига:

bash
Копировать код
python sort_books.py --demo-config
Тестовый прогон без копирования:

bash
Копировать код
python sort_books.py --src ./books_src --dst ./books_sorted --dry-run
Копирование файлов и создание hardlink’ов:

bash
Копировать код
python sort_books.py --src ./books_src --dst ./books_sorted
Полное перемещение файлов:

bash
Копировать код
python sort_books.py --src ./books_src --dst ./books_sorted --move
🔹 Особенности
На Windows hardlink создаются только если Source и Destination находятся на одном диске.

Если диски разные, hardlink заменяется на обычное копирование.

UTF-8 и русские символы полностью поддерживаются в именах файлов и папок.

🔹 Автор
Разработано для удобной сортировки коллекций электронных книг и документов по тематическим категориям с гибкой конфигурацией.